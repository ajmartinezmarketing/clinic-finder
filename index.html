
<!DOCTYPE html>
<html>
  <head>
    <title>Options Medical Location Finder</title>
    <style>
      body { font-family: Arial, sans-serif; max-width: 800px; margin: auto; padding: 20px; }
      #map { height: 400px; width: 100%; margin-top: 20px; }
      .result { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
    </style>
  </head>
  <body>
    <h2>Find Nearest Options Medical Clinic</h2>
    <input type="text" id="zipInput" placeholder="Enter ZIP Code" />
    <button onclick="findClinics()">Find Clinics</button>
    <div id="results"></div>
    <div id="map"></div>

    <script>
      const clinics = [
        { name: "Chandler", address: "2815 E Ocotillo Road, Suite 1, Chandler, AZ 85249" },
        { name: "Brandon", address: "2472 W Brandon Blvd, Brandon, FL 33511" },
        { name: "St Pete", address: "4301 4th St N, St. Petersburg, FL 33703" },
        { name: "Roswell", address: "10800 Alpharetta Hwy, Suite 212, Roswell, GA 30076" },
        { name: "Snellville", address: "1630 Scenic Hwy N, Suite C, Snellville, GA 30078" },
        { name: "Glenview", address: "1440 Waukegan Rd, Glenview, IL 60025" },
        { name: "Lakeview", address: "3212 N Lincoln Ave, Chicago, IL 60657" },
        { name: "Schaumburg", address: "2642 W Schaumburg Rd, Schaumburg, IL 60194" },
        { name: "Carmel", address: "2456 E 146th St, Carmel, IN 46033" }
      ];

      function findClinics() {
        const zip = document.getElementById("zipInput").value;
        const geocoder = new google.maps.Geocoder();
        const service = new google.maps.DistanceMatrixService();
        const resultsDiv = document.getElementById("results");
        resultsDiv.innerHTML = "Loading...";

        geocoder.geocode({ address: zip }, function(results, status) {
          if (status !== "OK" || results.length === 0) {
            resultsDiv.innerHTML = "Could not find location.";
            return;
          }

          const origin = results[0].geometry.location;
          const destinations = clinics.map(c => c.address);

          service.getDistanceMatrix({
            origins: [origin],
            destinations: destinations,
            travelMode: google.maps.TravelMode.DRIVING
          }, function(response, status) {
            if (status !== "OK") {
              resultsDiv.innerHTML = "Error getting distances.";
              return;
            }

            const elements = response.rows[0].elements;
            const enriched = clinics.map((clinic, i) => ({
              ...clinic,
              distance: elements[i].distance?.text || "N/A",
              duration: elements[i].duration?.text || "N/A",
              rawDistance: elements[i].distance?.value || Infinity
            })).sort((a, b) => a.rawDistance - b.rawDistance).slice(0, 3);

            let html = "";
            enriched.forEach(c => {
              html += `<div class="result"><strong>${c.name}</strong><br>${c.address}<br>Distance: ${c.distance}<br>Drive Time: ${c.duration}</div>`;
            });

            resultsDiv.innerHTML = html;
            showMap(origin, enriched);
          });
        });
      }

      function showMap(origin, clinics) {
        const map = new google.maps.Map(document.getElementById("map"), {
          zoom: 10,
          center: origin
        });
        new google.maps.Marker({ position: origin, map: map, label: "You" });

        const geocoder = new google.maps.Geocoder();
        clinics.forEach(c => {
          geocoder.geocode({ address: c.address }, (results, status) => {
            if (status === "OK" && results[0]) {
              new google.maps.Marker({
                position: results[0].geometry.location,
                map: map,
                title: c.name
              });
            }
          });
        });
      }
    </script>

    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB2ZRf58xsFPABXym2r1htg008auaGj6BI&callback=()=>{}">
    </script>
  </body>
</html>
